<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matchmaking - A NAGY Kacsapolás</title>
    <style>
        :root { 
            --gold: linear-gradient(45deg, #ffd700, #ff8c00); 
            --electric: #00f2ff; 
            --bg: #050505; 
        }

        body, html { 
            margin: 0; padding: 0; 
            background-color: var(--bg); 
            font-family: 'Arial Black', sans-serif; 
            overflow: hidden; 
            height: 100vh; 
            color: white; 
            perspective: 1000px;
        }

        /* ELEKTROMOS HÁTTÉR (Mindig a legalsó réteg) */
        .electric-container { 
            position: absolute; top: 0; left: 0; 
            width: 100%; height: 100%; 
            z-index: 1; pointer-events: none; 
        }
        .electric-arc { 
            fill: none; stroke: var(--electric); stroke-width: 3; 
            stroke-linecap: round; filter: drop-shadow(0 0 12px var(--electric)); 
            stroke-dasharray: 100, 1000; animation: flow 4s linear infinite; 
        }
        @keyframes flow { from { stroke-dashoffset: 1100; } to { stroke-dashoffset: 0; } }

        /* FŐ JÁTÉKABLAK (PiP támogatással) */
        #game-window {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 90%; height: 80%;
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 30px;
            backdrop-filter: blur(20px);
            z-index: 10;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: all 0.6s cubic-bezier(0.19, 1, 0.22, 1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        /* Kicsi nézet (Picture-in-Picture) stílus */
        #game-window.pip-mode {
            top: auto; left: auto;
            bottom: 30px; right: 30px;
            transform: translate(0, 0) scale(0.3);
            transform-origin: bottom right;
            border-color: var(--electric);
            box-shadow: 0 0 30px var(--electric);
            cursor: pointer;
        }

        /* ABLAKVEZÉRLŐK */
        .window-controls {
            position: absolute; top: 20px; left: 30px;
            display: flex; gap: 12px; z-index: 100;
        }
        .dot { 
            width: 16px; height: 16px; border-radius: 50%; 
            cursor: pointer; border: none; transition: 0.3s; 
        }
        .red { background: #ff5f56; }
        .yellow { background: #ffbd2e; }
        .green { background: #27c93f; }
        .dot:hover { transform: scale(1.3); filter: brightness(1.2); }

        /* TARTALOM ANIMÁCIÓK */
        .content {
            text-align: center;
            animation: zoomIn 0.5s ease-out;
        }

        @keyframes zoomIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .player-list {
            display: grid; grid-template-columns: repeat(5, 1fr);
            gap: 15px; margin: 30px 0; width: 80%;
        }

        .player-slot {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px 10px; border-radius: 15px;
            border: 1px dashed #444; font-size: 0.8rem;
            transition: all 0.4s ease;
        }

        .player-slot.filled {
            border-style: solid; border-color: #ffd700;
            background: rgba(255, 215, 0, 0.15);
            color: #ffd700; transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.2);
        }

        .loader {
            border: 4px solid #111; border-top: 4px solid #ffd700;
            border-radius: 50%; width: 50px; height: 50px;
            animation: spin 1s linear infinite; margin-bottom: 20px;
        }

        @keyframes spin { 100% { transform: rotate(360deg); } }

        h2 { text-transform: uppercase; letter-spacing: 2px; }

        #game-ui { display: none; }
    </style>
</head>
<body>

    <svg class="electric-container" viewBox="0 0 1000 1000" preserveAspectRatio="none">
        <path class="electric-arc" d="M 0,200 Q 150,500 0,800" />
        <path class="electric-arc" d="M 1000,200 Q 850,500 1000,800" />
        <path class="electric-arc" style="animation-duration: 3s" d="M 200,0 Q 500,100 800,0" />
    </svg>

    <div id="game-window">
        <div class="window-controls">
            <button class="dot red" onclick="location.href='index.html'"></button>
            <button class="dot yellow" onclick="togglePiP(true)"></button>
            <button class="dot green" onclick="togglePiP(false)"></button>
        </div>

        <div id="lobby-ui" class="content">
            <div class="loader"></div>
            <h2 id="status">Játékosok keresése (0/5)</h2>
            <div class="player-list" id="player-list"></div>
            <button onclick="location.href='index.html'" style="background:none; color:white; border:1px solid white; padding:10px 30px; cursor:pointer; border-radius:10px; opacity:0.6;">Mégse</button>
        </div>

        <div id="game-ui" class="content">
            <h1 style="color: #ffd700; font-size: 3rem;">JÁTÉK!</h1>
            <p id="timer" style="font-size: 1.5rem;">Vége: 5 mp</p>
        </div>
    </div>

    <script>
        const gameWindow = document.getElementById('game-window');
        const statusText = document.getElementById('status');
        const playerList = document.getElementById('player-list');
        const lobbyUI = document.getElementById('lobby-ui');
        const gameUI = document.getElementById('game-ui');

        let players = [];
        const botNames = ["Kacsa_Pro", "Quacker", "SárgaVész", "Pelyhes", "CsőrMester"];

        // PiP (Kicsi ablak) váltó funkció
        function togglePiP(enable) {
            if(enable) {
                gameWindow.classList.add('pip-mode');
            } else {
                gameWindow.classList.remove('pip-mode');
            }
        }

        // Slotok létrehozása
        for(let i=0; i<5; i++) {
            let slot = document.createElement('div');
            slot.className = 'player-slot';
            slot.innerText = "???";
            playerList.appendChild(slot);
        }

        // Matchmaking szimuláció animációval
        function findPlayers() {
            if (players.length < 5) {
                setTimeout(() => {
                    players.push(botNames[players.length]);
                    const slots = document.querySelectorAll('.player-slot');
                    slots[players.length - 1].innerText = players[players.length - 1];
                    slots[players.length - 1].classList.add('filled');
                    statusText.innerText = `Játékosok keresése (${players.length}/5)`;
                    findPlayers();
                }, Math.random() * 1500 + 500);
            } else {
                startMatch();
            }
        }

        function startMatch() {
            statusText.innerText = "MECCS MEGTALÁLVA!";
            setTimeout(() => {
                lobbyUI.style.display = 'none';
                gameUI.style.display = 'block';
                
                let count = 5;
                const interval = setInterval(() => {
                    count--;
                    document.getElementById('timer').innerText = `Vége: ${count} mp`;
                    if(count <= 0) {
                        clearInterval(interval);
                        location.href = 'index.html';
                    }
                }, 1000);
            }, 1500);
        }

        findPlayers();
    </script>
</body>
</html>